<!DOCTYPE html>
<html lang="pt-BR">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1.0">
    <title>Aguapura Vianet - Registro Água</title>
    <link rel="shortcut icon" href="img\favicon.png"/>

    <!-- Montserrat Font -->
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@100;200;300;400;500;600;700;800;900&display=swap" rel="stylesheet">

    <!-- Material Icons -->
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons+Outlined" rel="stylesheet">

    <!-- Custom CSS -->
    <link rel="stylesheet" href="css/coletadeagua.css">

  </head>
  <body>
    <div class="grid-container">

      <!-- Header -->
      <header class="header">
        <div class="menu-icon" onclick="openSidebar()">
          <span class="material-icons-outlined">menu</span>
        </div>
        <div class="header-right">
          <a href="logout.html" class="material-icons-outlined">
            <span class="material-icons-outlined"style="color: #2d437f; font-size: 36px;">account_circle</span>
        </a>
        </div>
      </header>
      <!-- End Header -->

      <!-- Sidebar -->
      <aside id="sidebar">
        <div class="sidebar-title">
          <div class="sidebar-brand">
            <a href="index.html" class="navbar-brand d-flex align-items-center px-2 px-lg-5" style="margin-left: -12px;">
                <img src="img/logo1.png" height="69" alt="logo">
            </a>
            <hr class="logo-divider">
          </div>
          <span class="material-icons-outlined" onclick="closeSidebar()">close</span>
        </div>
        <div class="menu-section font-weight-bold">
          <span class="menu-label">Menu principal</span>
        </div>
        <ul class="sidebar-list">
          <li class="sidebar-list-item font-weight-bold">
            <a href="dadosagua.html"> 
                <span class="material-icons-outlined">water_drop</span> Dados de água
            </a>
          </li>
          <li class="sidebar-list-item font-weight-bold">
            <a href="dadosenergia.html">
                <span class="material-icons-outlined">emoji_objects</span> Dados de energia
            </a>
          </li>
          <li class="sidebar-list-item font-weight-bold">
            <a href="contas.html">
                <span class="material-icons-outlined">payments</span> Finanças
            </a>
          </li>
          <li class="sidebar-list-item font-weight-bold">
            <a href="#">
                <span class="material-icons-outlined">home_work</span> Unidades
            </a>
          </li>
          <li class="sidebar-list-item font-weight-bold">
            <a href="#">
                <span class="material-icons-outlined">build</span> Equipamentos
            </a>
          </li>
          <li class="sidebar-list-item font-weight-bold">
            <a href="#">
                <span class="material-icons-outlined">home_repair_service</span> Serviços
            </a>
          </li>
        </ul>
        <div class="sidebar-footer">
          <p>2024 © Aguapura. Maintened by Ives e Gerson, All Rights Reserved.</p>
        </div>
      </aside>
      <!-- End Sidebar -->

      <!-- Main -->
      <main class="main-container">
        <div class="button-container">
          <button id="save-btn">Salvar</button>
          <button id="cancel-btn">Cancelar</button>
        </div>
        <!-- Container geral que contém os dois lados -->
        <div class="container">
          
          <!-- Primeiro container com Nome da Unidade, Medidor, Data e Hora da coleta -->
          <div class="left-container">
            <h2>Informações da Coleta</h2>
            <div class="unidade"> <!-- Contêiner com posição relativa -->
              <label for="unidade_id">Unidade:</label>
              <select id="unidade_id">
                <option value="" disabled selected>Selecione uma unidade</option>
                <option value="Administração">Administração</option>
                <option value="Arquitetura">Arquitetura</option>
                <option value="APUB">APUB</option>
                <option value="Belas Artes">Belas Artes</option>
                <option value="Belas Artes/Galeria Canizares">Belas Artes/Galeria Canizares</option>
                <option value="Biblioteca Central">Biblioteca Central</option>
                <option value="Biologia">Biologia</option>
                <option value="CEAO Garcia 1">CEAO Garcia 1</option>
                <option value="CEAO Garcia 2">CEAO Garcia 2</option>
                <option value="CEAO 2 de Julho">CEAO 2 de Julho</option>
                <option value="Ciência da Informação">Ciência da Informação</option>
                <option value="Ciências Econômicas">Ciências Econômicas</option>
                <option value="Comunicação">Comunicação</option>
                <option value="C P D - STI">C P D - STI</option>
                <option value="Creche">Creche</option>
                <option value="DCA Pav. V">DCA Pav. V</option>
                <option value="Dança">Dança</option>
                <option value="D C E">D C E</option>
                <option value="Div. Material">Div. Material</option>
                <option value="Direito">Direito</option>
                <option value="Educação">Educação</option>
                <option value="Educação/Setor de Esportes">Educação/Setor de Esportes</option>
                <option value="Enfermagem">Enfermagem</option>
                <option value="Farmácia">Farmácia</option>
                <option value="Filosofia 1">Filosofia 1</option>
                <option value="Filosofia 2">Filosofia 2</option>
                <option value="Física">Física</option>
                <option value="Física/Laboratório">Física/Laboratório</option>
                <option value="Geociências">Geociências</option>
                <option value="Gráfica Universitária">Gráfica Universitária</option>
                <option value="HUPES I">HUPES I</option>
                <option value="HUPES II">HUPES II</option>
                <option value="Hospital Magalhães Neto">Hospital Magalhães Neto</option>
                <option value="Hospital Infantil / CHR">Hospital Infantil / CHR</option>
                <option value="Hospital Veterinário">Hospital Veterinário</option>
                <option value="Inst Saúde Coletiva - ISC">Inst Saúde Coletiva - ISC</option>
                <option value="I S P Pav. IV">I S P Pav. IV</option>
                <option value="Letras">Letras</option>
                <option value="Matern. Climerio de Oliveira">Matern. Climerio de Oliveira</option>
                <option value="Matemática / S.T.I.">Matemática / S.T.I.</option>
                <option value="Medicina 2">Medicina 2</option>
                <option value="Medicina/Terreiro">Medicina/Terreiro</option>
                <option value="Medicina Veterinária">Medicina Veterinária</option>
                <option value="Medicina Veterinária/Bioterio">Medicina Veterinária/Bioterio</option>
                <option value="Memorial Lindemberg">Memorial Lindemberg</option>
                <option value="Museu de Arte Sacra">Museu de Arte Sacra</option>
                <option value="Música">Música</option>
                <option value="Nutrição">Nutrição</option>
                <option value="Odontologia">Odontologia</option>
                <option value="PAF 1">PAF 1</option>
                <option value="PAF 2">PAF 2</option>
                <option value="PCU/ SUMAI">PCU/ SUMAI</option>
                <option value="PCU 1/ SUMAI">PCU 1/ SUMAI</option>
                <option value="PCU 2/ SUMAI">PCU 2/ SUMAI</option>
                <option value="PCU 3/ SUMAI">PCU 3/ SUMAI</option>
                <option value="PCU/ Almoxarifado">PCU/ Almoxarifado</option>
                <option value="PCU/ Horto Florestal">PCU/ Horto Florestal</option>
                <option value="Pesq.Pós Graduação 1">Pesq.Pós Graduação 1</option>
                <option value="Pesq.Pós Graduação 2">Pesq.Pós Graduação 2</option>
                <option value="Politécnica">Politécnica</option>
                <option value="Pró Reitoria Extensão">Pró Reitoria Extensão</option>
                <option value="Química">Química</option>
                <option value="Reitoria">Reitoria</option>
                <option value="Residência 1">Residência 1</option>
                <option value="Residência 2">Residência 2</option>
                <option value="Residência 3">Residência 3</option>
                <option value="Residência 5">Residência 5</option>
                <option value="SAD/CGA/Pav VI">SAD/CGA/Pav VI</option>
                <option value="Serviço Médico /PAF VI">Serviço Médico /PAF VI</option>
                <option value="Secretaria Geral de Cursos">Secretaria Geral de Cursos</option>
                <option value="Superintendencia Acadêmica">Superintendencia Acadêmica</option>
                <option value="Superintendencia Acadêmica/SELEÇÃO 1">Superintendencia Acadêmica/SELEÇÃO 1</option>
                <option value="Superintendencia Acadêmica/SELEÇÃO 2">Superintendencia Acadêmica/SELEÇÃO 2</option>
                <option value="Superintendencia Acadêmica/SELEÇÃO 3">Superintendencia Acadêmica/SELEÇÃO 3</option>
                <option value="Sup. Estudantil">Sup. Estudantil</option>
                <option value="SPE Pavilhão 7">SPE Pavilhão 7</option>
                <option value="SPE Pavilhão 8">SPE Pavilhão 8</option>
                <option value="Teatro">Teatro</option>
                <option value="Vitória da Conquista (Hidro. 1)">Vitória da Conquista (Hidro. 1)</option>
                <option value="Galpão Patrimonio - UFBA">Galpão Patrimonio - UFBA</option>
                <option value="Residência 3 (Hidrometro 2)">Residência 3 (Hidrometro 2)</option>
                <option value="POUSADA NOVA HORIZONTE">POUSADA NOVA HORIZONTE</option>
                <option value="Residência Garibalde">Residência Garibalde</option>
                <option value="Vitória da Conquista (Hidro. 2)">Vitória da Conquista (Hidro. 2)</option>
                <option value="UFBA Cliníca Cardiointensiva">UFBA Cliníca Cardiointensiva</option>
                <option value="FAPEX">FAPEX</option>
              </select>
          </div>
        
            <label for="numero_medidor">Medidor:</label>
            <input type="text" id="numero_medidor" name="numero_medidor" placeholder="Digite o medidor">
            <!-- Grupo de Data e Hora, lado a lado -->
            <div class="date-time-group">
              <div>
                <label for=" data_coleta">Data da Coleta:</label>
                <input type="date" id="data-coleta" name="data-coleta">
              </div>
              <div>
                <label for="hora_coleta">Hora da Coleta:</label>
                <input type="time" id="hora_coleta" name="hora_coleta">
              </div>
            </div>
          </div>

          <!-- Segundo container com Resumo 1 e Resumo 2 -->
          <div class="right-container">
            <div class="overflow-hidden">
              <img class="img-fluid" src="img/hidro3.png" alt="">
            </div>
          
            <!-- Grupo de Resumo 1 e Resumo 2, lado a lado -->
            <div class="resumo-group">
              <div class="resumo resumo1">
                <label for="resumo1"></label>
                <textarea id="resumo1" name="resumo1"></textarea>
              </div>
              <div class="resumo resumo2">
                <label for="resumo2"></label>
                <textarea id="resumo2" name="resumo2"></textarea>
              </div>
            </div>
          </div>
        </div>
      </main>
      <!-- End Main -->

    </div>

    <!-- Scripts -->
    <!-- ApexCharts -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/apexcharts/3.35.3/apexcharts.min.js"></script>
    <!-- Custom JS -->
    <script src="js/coletadeagua.js"></script>
    <script>
      document.getElementById('save-btn').addEventListener('click', function () { 
        // Coletar os dados do formulário
        const unidadeId = document.getElementById('unidade_id').value;
        const numeroMedidor = document.getElementById('numero_medidor').value;
        const dataColeta = document.getElementById('data_coleta').value;
        const horaColeta = document.getElementById('hora_coleta').value;
        const resumo1 = document.getElementById('resumo1').value;
        const resumo2 = document.getElementById('resumo2').value;
    
        // Validar os campos obrigatórios
        if (!unidadeId || !numeroMedidor || !dataColeta || !horaColeta || !resumo1 || !resumo2) {
            alert('Por favor, preencha todos os campos obrigatórios.');
            return;
        }
    
        // Criar o objeto com os dados
        const formData = {
            unidade_id: unidadeId,
            numero_medidor: numeroMedidor,
            data_coleta: dataColeta,
            hora_coleta: horaColeta,
            leitura_medidor: resumo1+resumo2
        };
    
        // Enviar os dados para o backend
        fetch('http://localhost:3008/registroagua', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json'
            },
            body: JSON.stringify(formData)
        })
        .then(response => response.json())
        .then(data => {
            alert(data.message); // Exibe uma mensagem de sucesso ou erro
            if (data.success) {
                // Limpar o formulário após o sucesso
                document.getElementById('unidade_id').value = '';
                document.getElementById('numero_medidor').value = '';
                document.getElementById('data_coleta').value = '';
                document.getElementById('hora_coleta').value = '';
                document.getElementById('resumo1').value = '';
                document.getElementById('resumo2').value = '';
            }
        })
        .catch(error => {
            console.error('Erro:', error);
            alert('Ocorreu um erro ao registrar a coleta.');
        });
      });
    </script>
    
  </body>
</html>